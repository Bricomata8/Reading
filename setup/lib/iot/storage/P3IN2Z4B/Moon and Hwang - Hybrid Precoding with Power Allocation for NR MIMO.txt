Hybrid Precoding with Power Allocation for NR MIMOâ€“OFDM Systems

Sangmi Moon and Intae Hwang
School of Electronics and Computer Engineering Chonnam National University Gwangju, South Korea
msm0804@naver.com and hit@jnu.ac.kr

Abstractâ€”The International Telecommunication Union Radiocommunication Sector has established the concept of 5G communication, and is actively developing new radio (NR) standards for 5G applications, which have evolved significantly over existing long-term evolution standards. The proposed study presents a millimeter-wave-based multiple-inputâ€“multiple-output (MIMO) orthogonal frequency division multiplexing (OFDM) system to facilitate high-speed data transmission. The study proposes hybrid precoding with power allocation for use in conjunction with NR MIMOâ€“OFDM systems. Hybrid precoding comprises analog precoding to reduce implementation complexity and digital precoding to remove interference signals. Via application of a water-filling algorithm, the channel capacity can be maximized by allocating transmission power in accordance with the signal-to-noise ratio of subcarriers. Results obtained from simulations performed in this study demonstrate that compared to the conventional method, use of the proposed method leads to attainment of higher spectral efficiency.
Keywordsâ€” Hybrid precoding; Millimeter-wave; MIMOOFDM; NR; Power allocation
I. INTRODUCTION
To facilitate rapid increase in data usage and creation of new application services, the International Telecommunication Union-Radiocommunication Sector (ITU-R) has established the 5G mobile-communication technology and developed new radio (NR) standards for the same. The said NR standards are greatly evolved compared to the existing long-term evolution (LTE) standards. The 3rd-generation partnership project (3GPP) defines 5G technology based on the Release 15 standard. This technology primarily comprises of LTE and NR. NR is allowed to use a new physical channel structure and coding scheme based on a new wireless-access technology that is incompatible with the existing LTE platform.
The ITU-R has identified three different usage scenarios for 5G, including enhanced mobile broadband (eMBB), massive machine-type communications (mMTC), and ultra-reliable and low-latency communications (URLLC). The eMBB scenario is intended to realize a new user experience using ultra highdefinition, holograms, and VR content, particularly in hotspot areas with high user density and low mobility. For wide-area coverage, however, much higher data rates are to be provided, albeit lower compared to that in hotspot areas. In the mMTC scenario, low-cost internet-of-things (IoT) devices with long

battery lives are proposed to be made available to support short-burst machine-type communication (MTC) traffic, which may be less sensitive to delay. In other words, one of the most important scenarios of 5G usage has been considered with regard to facilitating efficient connectivity for a large number of IoT devices at low cost. The URLLC scenario corresponds to usage cases, such as industrial manufacturing, remote medical surgery, and safety in autonomous vehicles, which require more stringent capabilities in terms of throughput, latency, and availability [1, 2].
Requirements on part of 5G services are significantly higher compared to existing LTE networks, as depicted in Fig. 1. In particular, the requirement for eMBB corresponds to a maximum downlink transmission rate of 20 Gbpsâ€”nearly 20times that of LTEâ€”with a user-perceived transmission rate of the order of 100â€“1,000 Mbps. As a technological means to meet these requirements, millimeter-wave transmission systems have attracted increased attention in recent years. The millimeter-wave band refers to the 30â€“300 GHz bandwidth, the wavelength of which is in millimeters, and differs significantly from the sub-6 GHz band used in existing mobile communication networks. Millimeter-waves possess shortcomings, such as signal attenuation and reduced transmission distance, owing to their short wavelength and high frequencies. However, they are suitable for use in massive multiple-inputâ€“multiple-output (MIMO) systems, wherein multiple antennas can be installed within a small space. Based on these features, many studies have been performed to overcome large path losses encountered in the millimeter-wave band through use of the highly directional beamforming technique. The 3GPP network also adopts a standard called 'above-6 GHz' for communication in the millimeter-wave band [3, 4].
The beamforming technique can be divided into analog beamforming, fully digital beamforming, and hybrid beamformingâ€”a combination of the analog and digital types. Although analog beamforming involves rather low implementation complexity, it is difficult to implement the same in an arbitrary beamforming matrix. In fully digital beamforming, digital signal-processing techniques are used to implement arbitrary beamforming matrices, thereby facilitating inter-user interference and power control. However, the complexity of implementation is high because one RF chain is required for each antenna. Therefore, there is limits to the application of existing analog and fully digital beamforming

978-1-7281-1340-1/19/$31.00 Â©2019 IEEE

278

ICUFN 2019

techniques in massive MIMO systems. To address this concern, hybrid beamforming, which divides the beamforming process into digital and analog components [5], has been considered in this study.

where í µí±¯í µí±¯[í µí±˜í µí±˜] âˆˆ â„‚í µí±í µí±í µí±Ÿí µí±ŸÃ—í µí±í µí±í µí±¡í µí±¡ and í µí²›í µí²›[í µí±˜í µí±˜]~í µí²í µí²í µí²í µí²(í µí¿í µí¿, í µí¼í µí¼2í µí±°í µí±°í µí±í µí±í µí±Ÿí µí±Ÿ) denote the channel matrix and additive white Gaussian noise for subcarrier k, respectively.

Fig. 1. Example of a figure caption.

This study proposes the use of hybrid precoding with power allocation to develop a millimeter-wave-based MIMOâ€“OFDM system facilitating high-speed data transmission. The said hybrid precoding comprises analog precoding to reduce
implementation complexity and digital precoding to remove interference signals. During digital precoding, signals transmitted from other transmitting antennas are considered interference signals, and the zero-forcing (ZF) technique is applied to cancel or attenuate interference. The powerallocation process involves application of the water-filling algorithm. Thus, maximum channel capacity can be achieved by allocating transmission power in accordance with the signal-
to-noise ratio (SNR) in each subcarrier. The remainder of this paper has been organized as follows. Section 2 defines NRbased MIMOâ€“OFDM systems while section 3 provides an introduction to hybrid beamforming with power allocation. Section 4 describes performance analysis of the proposed scheme based on simulations. Lastly, section 5 lists major conclusions drawn from this study.

II. NR MIMO-OFDM SYSTEM MODEL

In the NR MIMOâ€“OFDM system depicted in Fig. 2, the

transmitter first precodes í µí±í µí±í µí± í µí±  data symbols í µí²”í µí²”[í µí±˜í µí±˜] at each

subcarrier í µí±˜í µí±˜ = 1, â€¦ , í µí°¾í µí°¾ â„‚í µí±í µí±í µí±…í µí±…í µí±…í µí±…Ã—í µí±í µí±í µí± í µí± . Subsequently,

using signals

digital precoding are transformed into

í µí±½í µí±½í µí°·í µí°·[í µí±˜í µí±˜] âˆˆ the time

domain using the í µí°¾í µí°¾-point inverse fast Fourier transform (IFFT).

After adding cyclic prefixes (CPs), the transmitter employs an analog precoding matrix í µí±½í µí±½í µí±…í µí±…í µí±…í µí±… âˆˆ â„‚í µí±í µí±í µí±¡í µí±¡Ã—í µí±í µí±í µí±…í µí±…í µí±…í µí±… to generate the final transmitted signal. The final signal transmitted at subcarrier í µí±˜í µí±˜

can be expressed as

í µí²™í µí²™[í µí±˜í µí±˜] = í µí±½í µí±½í µí±…í µí±…í µí±…í µí±…í µí±½í µí±½í µí°·í µí°·[í µí±˜í µí±˜]í µí²”í µí²”[í µí±˜í µí±˜]

(1)

where í µí²”í µí²”[í µí±˜í µí±˜] âˆˆ â„‚í µí±í µí±í µí± í µí± Ã—1 denotes the vector of transmitted data symbols at subcarrier í µí±˜í µí±˜. The received signal at subcarrier í µí±˜í µí±˜ can

be expressed as

í µí²ší µí²š[í µí±˜í µí±˜] = í µí±¯í µí±¯[í µí±˜í µí±˜]í µí²™í µí²™[í µí±˜í µí±˜] + í µí²›í µí²›[í µí±˜í µí±˜]

(2)

Fig. 2. Hybrid precoding structure for NR MIMOâ€“OFDM systems.

A. Channel model
To take millimeter-wave propagation characteristics into account, 3GPP developed a new channel model for the frequency band above 6 GHz [4]. The clustered delay line (CDL) model has been simplified for link-level implementation of a multi-antenna configuration. As a signal passes through each cluster present within the channel, it is dispersed into 20 rays to reach the receiving antenna. The normalized delay, power, azimuth angle of departure (AoD), zenith angle of departure (ZoD), azimuth angle of arrival (AoA), and zenith angle of arrival (ZoA) of each cluster are defined. Three CDL modelsâ€”CDL-A, CDL-B, and CDL-Câ€”have been constructed to represent three different channel profiles for NLOS while CDL-D and CDL-E have been constructed for LOS. Generation of the channel coefficient in the CDL model can be accomplished via following steps [3, 4].

Step 1: Generation of departure and arrival angles in accordance with per-cluster departure and arrival angles and ray-offset angles within a cluster.

Step 2: Coupling of departure and arrival rays within a cluster.

Step 3: Cross-polarization power-ratio generation for each ray.

Step 4: Channel-coefficient generation.

The NLOS channel coefficient í µí°»í µí°»í µí µí±¢í µí±í±¢í µ,í±í µí µí± í±í µí µí± í±,í µí µí±í±›í µí µí±í±›í µ,í±í µí µí±í±ší µí±š(í µí±¡í µí±¡) of the í µí±ší µí±š-th ray in the í µí±›í µí±›-th cluster between receiving and transmitting antennas (í µí±¢í µí±¢ and í µí± í µí± , respectively) at time instant í µí±¡í µí±¡ and delay í µí¼í µí¼ can be expressed as

í µí°»í µí°»í µí µí±¢í µí±í±¢í µ,í±í µí µí± í±í µí µí± í±,í µí µí±í±›í µí µí±í±›í µ,í±í µí µí±í±ší µí±š(í µí±¡í µí±¡) = âˆší µí µí±ƒí µí±€í±ƒí µí µí±›í±€í µí±› [í µí µí°¹í°¹í µí µí°¹í°¹í µí µí±Ÿí±Ÿí µí µí±Ÿí±Ÿí µí µí±Ÿí±Ÿí µí µí±Ÿí±Ÿ,,í µí µí±¢í±¢í µí µí±¢í±¢,,í µâˆ…í¼ƒí µí¼ƒ((í µí µí¼ƒí¼ƒí µí µí¼ƒí¼ƒí µí µí±›í±›í µí µí±›í±›,,í µí µí±ší±ší µí µí±ší±š,,í µí µí±í±í µí µí±í±í µí µí±í±í µí µí±í±,, âˆ…âˆ…í µí µí±›í±›í µí µí±›í±›,,í µí µí±ší±ší µí µí±ší±š,,))]í µí±‡í µí±‡

(3)

exp(í µí±—í µí±—í µí»·í µí»·í µí±›í µí µí¼ƒí±›í µ,í¼ƒí µí µí¼ƒí±ší µí µí¼ƒí±š) âˆší µí°¾í µí°¾í µí±›í µí±›,í µí±ší µí±šâˆ’1 exp(í µí±—í µí±—Î¦í µí µí±›í¼ƒí µí µí±›í¼ƒ,âˆ…í µí±ší µí±š)

[ âˆší µí°¾í µí°¾í µí±›í µí±›,í µí±ší µí±šâˆ’1exp(í µí±—í µí±—í µí»·í µí»·í µí±›âˆ…í µí±›,í µí µí¼ƒí±ší µí µí¼ƒí±š) exp(í µí±—í µí±—Î¦í µâˆ…í±›í µí±›,âˆ…í µí±ší µí±š) ] [í µí µí°¹í°¹í µí µí°¹í°¹í µí µí±¡í±¡í µí µí±¡í±¡,,í µí µí± í± í µí µí± í± ,,í µâˆ…í¼ƒí µí¼ƒ((í µí µí¼ƒí¼ƒí µí µí¼ƒí¼ƒí µí µí±›í±›í µí µí±›í±›,,í µí µí±ší±ší µí µí±ší±š,,í µí µí±í±í µí µí±í±,, âˆ…âˆ…í µí µí±›í±›í µí µí±›í±›,,í µí µí±ší±ší µí µí±ší±š,,))] exp (í µí±—í µí±—2í µí¼‹í µí¼‹í µí¼†í µí¼†âˆ’01(í µí±Ÿí µí µí±Ÿí±ŸÌ‚í µí µí±Ÿí±‡í µí µí±Ÿí±‡í µí±Ÿ,í µí±›í µí±›,í µí±ší µí±š âˆ™ í µí±‘í µí±‘í µÌ… í±Ÿí µí±Ÿí µí±Ÿí µí±Ÿ,í µí±¢í µí±¢)) exp(í µí±—í µí±—2í µí¼‹í µí¼‹í µí¼†í µí¼†âˆ’01(í µí±Ÿí µí µí±ŸÌ‚í±¡í µí µí±¡í±‡í µí±‡ ,í µí±›í µí±›,í µí±ší µí±š âˆ™ í µí±‘í µí±‘í µÌ…í±¡í µí±¡,í µí± í µí± ))exp(í µí±—í µí±—2í µí¼‹í µí¼‹í µí±£í µí±£í µí±›í µí±›,í µí±ší µí±ší µí±¡í µí±¡)

279

where

í µí±ƒí µí µí±ƒí±›í µí±›: power of the n-th cluster on a linear scale í µí°¹í µí°¹í µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿ,í µí±¢í µí±¢,í µí¼ƒí µí¼ƒ(Â·,Â·) , í µí°¹í µí°¹í µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿ,í µí±¢í µí±¢,âˆ…(Â·,Â·) : radiation patterns of the receiving antenna along í µí¼ƒí µí¼ƒ and í µí¼™í µí¼™ directions, respectively

í µí°¹í µí°¹í µí±¡í µí±¡,í µí± í µí± ,í µí¼ƒí µí¼ƒ(Â·,Â·), í µí°¹í µí°¹í µí±¡í µí±¡,í µí± í µí± ,âˆ…(Â·,Â·) : radiation patterns of the transmitting antenna along í µí¼ƒí µí¼ƒ and í µí¼™í µí¼™ directions, respectively

{í µí»·í µí»·í µí±›í µí µí¼ƒí±›í µ,í¼ƒí µí µí¼ƒí±ší µí µí¼ƒí±š, Î¦í µí µí±›í¼ƒí µí µí±›í¼ƒ,âˆ…í µí±ší µí±š, Î¦í µâˆ…í±›í µí±›,í µí µí¼ƒí µí±ší¼ƒí µí±š, Î¦í µâˆ…í±›í µí±›,âˆ…í µí±ší µí±š}: set of random initial phases of the four different polarization combinationsâ€”í µí¼ƒí µí¼ƒí µí¼ƒí µí¼ƒ, í µí¼ƒí µí¼ƒ, í µí¼™í µí¼™, and í µí¼™í µí¼™í µí¼™í µí¼™

í µí°¾í µí°¾í µí±›í µí±›,í µí±ší µí±š: cross polarization power ratio (XPR) for the n-th cluster and m-th ray

í µí¼†í µí¼†0: carrier frequency wavelength

í µí±Ÿí µí µí±Ÿí±ŸÌ‚í µí±Ÿí µí±Ÿí µí±Ÿ,í µí±›í µí±›,í µí±ší µí±š , í µí±Ÿí µí µí±Ÿí±¡Ì‚í µí±¡,í µí±›í µí±›,í µí±ší µí±š : spherical unit vectors of the receiving and transmitting antennas, respectively í µí±‘í µí±‘í µÌ… í±Ÿí µí±Ÿí µí±Ÿí µí±Ÿ,í µí±¢í µí±¢, í µí±‘í µí±‘Ì…í µí±¡í µí±¡,í µí± í µí± : location vectors for the receiving and transmitting antennas, respectively

í µí±£í µí±£í µí±›í µí±›,í µí±ší µí±š: velocity vector

For the LOS path, í µí°»í µí°»í µí µí±¢í°¿í µí µí±¢í°¿,í µí°¿í µí± í µí µí°¿í± í µ,í°¿1í µí°¿ (í µí±¡í µí±¡) can be expressed as

í µí°»í µí°»í µí µí±¢í°¿í µí µí±¢í°¿,í µí µí°¿í± í µí µí± í°¿í µ,í°¿1í µí°¿ (í µí±¡í µí±¡) = [í µí µí°¹í°¹í µí µí°¹í°¹í µí µí±Ÿí±Ÿí µí µí±Ÿí±Ÿí µí µí±Ÿí±Ÿí µí µí±Ÿí±Ÿ,,í µí µí±¢í±¢í µí µí±¢í±¢,,í µâˆ…í¼ƒí µí¼ƒ((í µí µí¼ƒí¼ƒí µí µí¼ƒí¼ƒí µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿,,í µí µí±í±í µí µí±í±í µí µí±í±í µí µí±í±,, âˆ…âˆ…í µí µí°¿í°¿í µí µí°¿í°¿í µí°¿í µí°¿í µí°¿í µí°¿,,))]í µí±‡í µí±‡

(4)

[0expâˆ’(í µí±—í µeí±—í µí»·í µxí»·í µí°¿pí µí°¿í µí°¿í µ(í°¿í µí°¿í µí µí°¿í±—í µ)í±—í µí»·í µí»·í µí°¿í µí°¿í µí°¿í µí°¿0í µí°¿í µí°¿)] [í µí µí°¹í°¹í µí µí°¹í°¹í µí µí±¡í±¡í µí µí±¡í±¡,,í µí µí± í± í µí µí± í± ,,í µâˆ…í¼ƒí µí¼ƒ((í µí µí¼ƒí¼ƒí µí µí¼ƒí¼ƒí µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿,,í µí µí±í±í µí µí±í±í µí µí±í±í µí µí±í±,, âˆ…âˆ…í µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿í µí µí°¿í°¿,,))]

exp (í µí±—í µí±—2í µí¼‹í µí¼‹í µí¼†í µí¼†âˆ’01(í µí±Ÿí µí µí±Ÿí±ŸÌ‚í µí µí±Ÿí±‡í µí µí±Ÿí±‡í µí±Ÿ,í µí°¿í µí°¿í µí°¿í µí°¿í µí°¿í µí°¿ âˆ™ í µí±‘í µí±‘Ì…í µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿ,í µí±¢í µí±¢)) âˆ™ exp(í µí±—í µí±—2í µí¼‹í µí¼‹í µí¼†í µí¼†âˆ’01 (í µí±Ÿí µí µí±Ÿí±¡Ì‚í µí µí±¡í±‡í µí±‡ ,í µí°¿í µí°¿í µí°¿í µí°¿í µí°¿í µí°¿ âˆ™ í µí±‘í µí±‘Ì…í µí±¡í µí±¡,í µí± í µí± )) âˆ™ exp(í µí±—í µí±—2í µí¼‹í µí¼‹í µí±Ÿí µí µí±Ÿí±¡Ì‚í µí µí±¡í±‡í µí±‡ ,í µí°¿í µí°¿í µí°¿í µí°¿í µí°¿í µí°¿í µí±£í µí±£Ì…í µí±¡í µí±¡/í µí¼†í µí¼†0)

III. PROPOSED HYBRID PRECODING WITH POWER ALLOCATION

A. Hybrid precoding

A uniform rectangular-panel array with multiple antennas has been considered in this study. Antenna elements are placed
along the vertical and horizontal directions, as depicted in Fig. 3, where N denotes the number of columns; M denotes the number of antenna elements with the same polarization in each column. Additionally, antenna elements have been uniformly spaced along the horizontal and vertical directions with spacing dH and dV, respectively. The antenna array response vector in a uniform rectangular panel array configuration can be
expressed as [7]

í µí²‚í µí²‚(í µí¼ƒí µí¼ƒ,

í µí¼™í µí¼™)

=

1 âˆší µí±€í µí±€í µí±€í µí±€

(1,

â€¦

,

í µí±’í µí±’í µí±—í µí±—í µí±—í µí±—í µí±—í µí±—(í µí±ší µí±šsin(í µí¼™í µí¼™) sin(í µí¼ƒí µí¼ƒ))+í µí±›í µí±› cos(í µí¼ƒí µí¼ƒ),

â€¦,

(5)

í µí±’í µí±’í µí±—í µí±—í µí±—í µí±—í µí±—í µí±—((í µí±€í µí±€âˆ’1)sin(í µí¼™í µí¼™) sin(í µí¼ƒí µí¼ƒ))+(âˆ’1) cos(í µí¼ƒí µí¼ƒ))í µí±‡í µí±‡

where 0 < í µí±ší µí±š < í µí±€í µí±€ âˆ’ 1 and 0 < í µí±›í µí±› < í µí±í µí± âˆ’ 1 denote the vertical and horizontal indices, respectively, of an antenna element, and the total number of antenna elements equal í µí±€í µí±€ . Additionally, í µí±˜í µí±˜ = 2í µí¼‹í µí¼‹/í µí¼†í µí¼†0 , and í µí±‘í µí±‘ = í µí±‘í µí±‘í µí±‰í µí±‰ = í µí±‘í µí±‘í µí°»í µí°» represents the antenna-element spacing.

B. Frame structure
To effectively use the wide bandwidth of the millimeterwave band using OFDM, a new frame structure is required. To facilitate this, 5G NR supports various transmission-frame structures. By introducing the numerology parameter (Î¼), the subcarrier on the resource grid of existing LTE networks can be extended to set the subcarrier interval as flexible [6]. The numerology can be set from 0 to 4, as described in Table 1. The subcarrier spacing can, therefore, be made scalable to 2í µí¼‡í µí¼‡ Ã— 15 kHz depending on the channel bandwidth. Also, the FFT size can be flexibly adjusted so that processing complexity does not increase unnecessarily for a wider bandwidth. The number of slots per subframe can be increased by a factor 2í µí¼‡í µí¼‡.

TABLE I.

SUBCARRIER SPACING AND NUMBER OF SLOTS PER SUBFRAME ACCORDING TO NUMEROLOGY.

Numerology (Î¼) 0 1 2 3 4

2í µí¼‡í µí¼‡ Ã— 15 [kHz] 15 30 60 120 240

Number of slots per subframe 1 2 4 8 16

Fig. 3. Antenna configuration with uniform rectangular panel array.

Analog radio frequency (RF) precoding can be configured as follows using the azimuth and zenith angles.

í µí±‰í µí±‰í µí±…í µí±…í µí±…í µí±… = [í µí²‚í µí²‚í µí±¡í µí±¡(í µí¼ƒí µí¼ƒ1í µí±¡í µí±¡,1, í µí¼™í µí¼™1í µí±¡í µí±¡,1), í µí²‚í µí²‚í µí±¡í µí±¡(í µí¼ƒí µí¼ƒ1í µí±¡í µí±¡,2, í µí¼™í µí¼™1í µí±¡í µí±¡,2), â€¦,

(6)

í µí²‚í µí²‚í µí±¡í µí±¡ (í µí¼ƒí µí¼ƒí µí±¡í µí±¡ í µí±í µí±í µí±í µí±í µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿ , í µí¼™í µí¼™í µí±¡í µí±¡ í µí±í µí±í µí±í µí±í µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿ )
where í µí±í µí±í µí±í µí±í µí±í µí± denotes the number of clusters and í µí±í µí±í µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿí µí±Ÿ denotes the number of rays in each cluster.

In addition, signals sent from other transmitting antennas
are considered interference signals, and digital precoding is performed to eliminate them. To avoid excess implementation complexity, digital precoding uses ZFâ€”a linear precoding techniqueâ€”to cancel or attenuate interference. Therefore, digital precoding in the subcarrier can be performed in accordance with the following relation whilst considering an effective channel.

í µí±½í µí±½[í µí±˜í µí±˜] = (í µí±¯í µí±¯eí µí°»í µí°»ff[í µí±˜í µí±˜]í µí±¯í µí±¯eff[í µí±˜í µí±˜])âˆ’1í µí±¯í µí±¯eff[í µí±˜í µí±˜]

(7)

where í µí±¯í µí±¯eff[í µí±˜í µí±˜] = í µí±¯í µí±¯[í µí±˜í µí±˜]í µí±½í µí±½í µí±…í µí±…í µí±…í µí±… represents an effective channel.

280

B. Power allocation

When the total average transmitted power is constrained,
the maximum obtainable channel capacity for a given power allocation í µí±·í µí±· = [í µí±ƒí µ0í±ƒ , â€¦ , í µí±ƒí µí µí±ƒí°¾í µí°¾âˆ’1] can be expressed as

max
í µí±ƒí µí±ƒ0 ,â€¦,í µí±ƒí µí±ƒí µí°¾í µí°¾âˆ’1

í µí°¶í µí°¶(í µí±·í µí±·)

=

âˆ‘í µí µí±˜í°¾í µí µí±˜í°¾=0

log2

(1

+

í µí±ƒí µí±ƒ[í µí±˜í µí±˜]í µ|í¼í µí µí¼í°»2í µí°»[í µí±˜í µí±˜]|2)

(8)

subject to âˆ‘í µí µí±˜í°¾í µí µí±˜í°¾=0 í µí±ƒí µí±ƒ[í µí±˜í µí±˜] â‰¤ í µí±ƒí µí±ƒ

where í µí°»í µí°»[í µí±˜í µí±˜] , í µí¼í µí¼2 , and í µí±ƒí µí±ƒ[í µí±˜í µí±˜] , denote the channel frequency response, noise variance, and transmitting power of the í µí±˜í µí±˜-th subcarrier, respectively. It is possible to obtain an optimized
solution to Eq. (8) using the Lagrangian method.

í µí°½í µí°½(í µí±·í µí±·) = í µí°¶í µí°¶(í µí±·í µí±·) âˆ’ í µí¼†í µí¼†([âˆ‘í µí µí±˜í°¾í µí µí±˜í°¾=0 í µí±™í µí±™í µí±™í µí±™í µí±™í µí±™2 í µí±ƒí µí±ƒ[í µí±˜í µí±˜]] âˆ’ í µí±ƒí µí±ƒ)

(9)

=

í µí°¾í µí°¾
âˆ‘

log2

(1

+

í µí±ƒí µí±ƒ[í µí±˜í µí±˜]|í µí°»í µí°»[í µí±˜í µí±˜ í µí¼í µí¼ 2

]|2)

âˆ’

í µí¼†í µí¼†

í µí°¾í µí°¾
([âˆ‘

í µí±™í µí±™í µí±™í µí±™í µí±™í µí±™2

í µí±ƒí µí±ƒ[í µí±˜í µí±˜]]

âˆ’

í µí±ƒí µí±ƒ)

í µí±˜í µí±˜=0

í µí±˜í µí±˜=0

By setting the first derivative of í µí°½í µí°½(í µí±·í µí±·) to zero we get

í µí±ƒí µí±ƒ[í µí±˜í µí±˜]

=

í µí±í µí±

âˆ’

í µí¼í µí¼2 |í µí°»í µí°»[í µí±˜í µí±˜]|2

(10)

By choosing a such that the power constraint is satisfied, a water-filling solution can be obtained as under

í µí±ƒí µí±ƒ[í µí±˜í µí±˜]âˆ—

=

(í µí±í µí±

âˆ’

í µí¼í µí¼2 |í µí°»í µí°»[í µí±˜í µí±˜]|2

+
)

(11)

with [í µí±¥í µí±¥]+ = í µí±¥í µí±¥ , if í µí±¥í µí±¥ > 0 ; else [í µí±¥í µí±¥]+ = 0 . Maximum channel capacity can, therefore, be achieved by allocating transmission
power in accordance with the SNR within each subcarrier. Fig.

4 presents a graphical description of power allocation in conjunction with the water-filling algorithm.

Fig. 4. Power allocation with water filling algorithm.
IV. SIMULATION RESULTS AND PERFORMANCE ANALYSIS
Simulation results and analysis of performance of the proposed hybrid beamforming with power allocation, mentioned in the previous section, is presented herein. Parameters used in the simulation were based on the 50-MHz bandwidth with 28-GHz carrier frequency of the 3GPP NR MIMOâ€“OFDM systems. Table 2 lists general simulation parameters that define the simulation environment. The channel environment was used to model the millimeter-wave channel based on CDL-B.

TABLE II.

SIMULATION PARAMETERS.

Parameters

Assumptions

Carrier frequency

28 GHz

Bandwidth

50 MHz

Subcarrier spacing

60 kHz

Cyclic prefix Antenna configuration Channel model

Normal CP í µí±í µí±í µí±¡í µí±¡ Ã— í µí±í µí±í µí±Ÿí µí±Ÿ : 64 Ã— 16, 256 Ã— 64 and í µí±í µí±í µí±…í µí±…í µí±…í µí±… = 16 CDL-B

A 64Ã—16 MIMO-OFDM system was considered in this
study with a hybrid precoding structure at the transmitter with í µí±í µí±í µí±…í µí±…í µí±…í µí±… = 16. Fig. 5 depicts that the proposed hybrid precoding with power allocation facilitates attainment of a spectral efficiency higher compared to that obtained using hybrid precoding alone. It can also be seen that proposed hybrid precoding with power allocation is close to fully digital precoding performance.

64Ã—16 MIMO-OFDM system with NRF=16 45

Fully digital BF

40

Proposed BF with power allocation

Hybrid BF

35

Spectral efficiency [bps/Hz]

30

25

20

15

10

5

0

2

4

6

8 10 12 14 16 18 20

SNR [dB]

Fig. 5. Spectral efficiency of 64Ã—16 MIMOâ€“OFDM system with NRF=16.

Fig. 6 shows the spectral efficiency when the antenna
configuration is 64Ã—16 MIMO-OFDM system with í µí±í µí±í µí±…í µí±…í µí±…í µí±… = 16. Performance analysis was performed similarly as explained in Fig. 5.

256Ã—64 MIMO-OFDM system with NRF=16 70

Fully digital BF

Proposed BF with power allocation

60

Hybrid BF

50

Spectral efficiency [bps/Hz]

40

30

20

10

0

2

4

6

8

10 12 14 16 18 20

SNR [dB]

Fig. 6. Spectral efficiency of 256Ã—64 MIMOâ€“OFDM system with NRF=16.

281

V. CONCLUSION
This paper considers millimeter-wave-based MIMOâ€“ OFDM systems, and proposes use of the same in conjunction with hybrid precoding with power allocation. The proposed hybrid-precoding procedure comprises analog precoding to reduce implementation complexity and digital precoding to remove interference signals. Through application of the waterfilling algorithm, the channel capacity has been demonstrated to be maximized by allocating transmission power in accordance with the signal-to-noise ratio of subcarriers. Simulation results demonstrate that the proposed method exhibits enhanced spectral efficiency when compared to conventional methods.
ACKNOWLEDGMENT
"This research was supported by the MSIT(Ministry of Science and ICT), Korea, under the ITRC(Information Technology Research Center) support program (IITP-2018-

2016-0-00314) supervised by the IITP(Institute for Information & communications Technology Promotion)."
"This work was supported by the National Research Foundation of Korea(NRF) grant funded by the Korea government (MSIT: Ministry of Science and ICT) (2018R1A2B6002255)."
REFERENCES
[1] ITU Recommendation ITU-R M.2083-0, September 2015.
[2] Andrews, Jeffrey G., et al. â€œWhat will 5G be?, â€ IEEE Journal on selected areas in communications, vol. 32, no. 6, pp. 1065-1082, 2014.
[3] 3GPP TR 38.900 V15.0.0 (2018-06), Study on channel model for frequency spectrum above 6 GHz (Release 15).
[4] 3GPP TR 38.901 V15.0.0 (2018-06), Study on channel model for frequencies from 0.5 to 100 GHz (Release 15).
[5] O. Ayach and R. Heath, â€œLow complexity precoding for large millimeter wave MIMO systems,â€ in Proc. of IEEE International Conference on Communications (ICC), Ottawa, Canada, Jun. 2012.
[6] 3GPP TS 38.211 V15.3.0 (2018-09), Physical channels and modulation (Release 15)
[7] C. Balanis, Antenna theory. Wiley New York, 1997.

282

