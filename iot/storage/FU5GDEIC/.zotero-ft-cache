RIOT an Open Source Operating System
for Low-end IoT Devices
Emmanuel Baccelli

Agenda
ยง Context ยง RIOT ยง IoT Energy Efficiency ยง IoT Security ยง RIOT & SILECS
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

IoT Hardware
Internet
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Low-end IoT devices - 1000x less energy than
RaspberryPi - kBytes instead of GBytes of memory
Microcontrollers e.g. AVR (8-bit) MSP430 (16-bit) Cortex M (32-bit) MIPS โฆ

Low-end IoT Devices : Polymorphism
ยง Various vendors ยง Various architectures (8-bit, 16-bit, 32-bit) ยง Various low-power communication technologies (BLE, 802.15.4, DECTโฆ)
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Biff Tenon

Context
ยง Ubiquitous computing & connectivity is upon us
ยง Giant cyberphysical robot ยง High-end IoT vs Low-end IoT
ยง Extreme computing power becomes average
ยง Now: pooled power, from NSA to botnets & everything in between (e.g. Coinhive covert mining ads)
ยง Later: quantum computing?
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Microsoft

Context

Anonymous

ยง World War III is upon us (online)
ยง geopolitically-driven (state-driven) ยง profit-driven (pirates, zero-day attacks)

ยง Personal data-hungry Behemoths are upon us
ยง captive users, walled gardens, not necessarily secure ยง EU fightback: General Data Protection Regulation (GDPR)

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

reality.ai

You donโt control what you canโt program
โข Software platform on usual machines: Linux
รผ provides programmability & full control for developers & users
โข On low-end IoT devices?
Old : Closed-source, vendor-locked software Next : RIOT & new open-source IoT operating systems
O. Hahm et al. "Operating Systems for Low-End Devices in the Internet of Things: a Survey," IEEE Internet of Things Journal, 2016.
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Agenda
ยง Context ยง RIOT ยง IoT Energy Efficiency ยง IoT Security ยง RIOT & SILECS
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

RIOT
ยง Kernel Characteristics ยง System-level Interoperability ยง Network-level Interoperability ยง Open-source Community Aspects
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Principles for General Purpose OS for IoT

รผ Unified APIs โ across all hardware, even for hardware-accessing APIs; Brings code portability and minimizes code duplication;
รผ Vendor & Technology Independence โ Vendor libraries are avoided; Design decisions donโt tie RIOT to a particular technology;
รผ Modularity โ building blocks, to be combined in all thinkable ways; Caters for versatile use cases & memory constraints;
รผ Static Memory โ extensive use of pre-allocated structs; Caters for reliability, simplified verification, and real-time requirements;

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

10

RIOT: Kernel Overview

Modular architecture based on a minimal, real-time kernel
ยง Multi-threading, thread synch. with mutexes, semaphores and IPC ยง Separate thread context & memory stack (but single memory space)

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

How? รผSmall Thread Control Block (TCB) รผMinimized Stack Usage รผSmall & fast Inter-Process Communication (IPC) รผTickless, O(1) scheduler w. priorities & preemption (Note: Multi-threading is optional)
E. Baccelli et al. "RIOT: an Open Source Operating System for Low-end Embedded Devices in the IoT," IEEE Internet of Things Journal, 2018 (to appear).

RIOT: Kernel Overview
Default configuration, 2 threads: ยง main thread running the main function ยง idle thread: lowest priority
รผfallback when other threads are blocked/done รผthe idle thread automatically switches to the lowest possible power mode
ยง (ISR context handles external events and notifies threads using IPC)
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

RIOT: Kernel Overview

Some numbersโฆ
On a low-end IoT device (16-bit, 8 MHz): รผ Min. TCB: 8 bytes; Min. Stack Size: 96 bytes รผ IPC: up to 16,000 Messages/s (~ 10k Packets/s for 802.15.4) รผ Kernel: requires only 1kB RAM and 2kB Flash

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

More numbersโฆ รผ On Cortex-M (32-bit): Kernel is 2,8kB RAM and 3.2kB Flash รผ On AVR (8-bit): Kernel is 800B RAM and 4.2kB Flash

RIOT
ยง Kernel Characteristics ยง System-level Interoperability ยง Network-level Interoperability ยง Open-source Community Aspects
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

RIOT: System-level Interoperability

Libraries
xtimer, . . .
Core APIs
Core
CPU abstraction

Applications sock

Network stacks

SAUL

netdev

Network Device Drivers

Sensor/Actuator Drivers

Periph APIs

Hardware

ยง Core of RIOT in (ANSI) C ยง No macro โmagicโ ยง Board/cpu/drivers abstraction layer
ยง Well defined APIs, consistent across all supported hardware
ยง Cherry-picking POSIX

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

RIOT: System-level Interoperability

C, C++ (JavaScript, Rust)

Libraries
xtimer, . . .
Core APIs
Core
CPU abstraction

Applications sock

Network stacks

SAUL

netdev

Network Device Drivers

Sensor/Actuator Drivers

Periph APIs

Hardware

ยง Drawbacks:
ยง some memory overhead, but still fits low-end IoT devices memory budget
ยง some more work because re-implement from scratch (behind vendor header files)
ยง Advantages:
ยง Efficient & highly reusable code across all supported hardware
ยง Emulation of RIOT as a Linux process ยง Reusability of well-known 3rd-party tools
such as gdb, valgrind, gprofโฆ

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

RIOT: System-level Interoperability

Libraries
xtimer, . . .
Core APIs
Core
CPU abstraction

Applications sock

Network stacks

SAUL

netdev

Network Device Drivers

Sensor/Actuator Drivers

Periph APIs

Hardware

ยง Packages: bundling 3rd-party libraries
ยง Integrated on-the-fly at buildโtime ยง Easy to add: just requires 2 Makefiles
ยง Patches (if needed) are typically minimal

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

RIOT: Network-level Interoperability

Libraries
xtimer, . . .
Core APIs
Core
CPU abstraction

Applications sock

Network stacks

SAUL

netdev

Network Device Drivers

Sensor/Actuator Drivers

Periph APIs

Hardware

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Wired & Bus ยง CAN ยง Ethernet
Low-power wireless LAN & WAN ยง IEEE 802.15.4 ยง LoRa package ยง BLE (work-in-progress)
IP Protocols Stacks ยง Default stack (GNRC) ยง Thread (package) ยง lwIP (package) ยง OpenWSN (in progress)
Experimental stacks ยง CCN-lite (package) ยง NDN-RIOT (package)

RIOT
ยง Kernel Characteristics ยง System-level Interoperability ยง Network-level Interoperability ยง Open-source Community Aspects
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

RIOT: Large Open-Source Community

Source: www.openhub.net/p/RIOT-OS

github.com/RIOT-OS/RIOT Monthly contributors

ยง 2013: started as French-German research project
ยง 2018: more than 180 contributors worldwide
ยง 17,000 commits and 7,200 Pull Requests ยง Support for 100+ types of hardware platforms ยง First products shipping RIOT last year ยง Hundreds of related scientific publications

Lines of code
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

ยง Yearly RIOT Summit conference
next in Amsterdam, Sept. 13-14, see http://summit.riot-os.org

RIOT: Large Open-Source Community

Grassroots governance by two bodies
ยง see https://github.com/RIOT-OS/RIOT/wiki/RIOT-Community-Processes

Maintainers ยง Status acquired via meritocracy on Github ยง Duties: review incoming code contributions ยง Rights: can merge in the master branch

RIOT e.V.

Coordinators ยง Status granted by co-founders ยง Duties: strategy steering ยง Rights: some praise ;)
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Some Deployments & Products Using RIOT
ยง Telefonica (Chile): deployment in a copper mine ยง Cisco (USA) and Huawei (USA): test deployments of ICN-IoT ยง Algramo (Chile): deployment in fleet of cereal vending machines
ยง Hamilton IoT (USA) : environment sensing hardware + cloud services ยง Unwired devices (Russia): LoRa communication module ยง Eisox (France): smart heating
ยง Upcoming products
ยง OTAKeys / Continental (Belgium): On-Board diagnostics for connected cars ยง Sleeping Beauty (Germany): GPS tracking device with an integrated GSM modem
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Agenda
ยง Context ยง RIOT ยง IoT Energy Efficiency ยง IoT Security ยง RIOT & SILECS
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

IoT Energy Efficiency
ยง Motivation ยง Cooperative caching with ICN-IoT ยง Experimental results
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Standard IoT energy efficiency

Protocols
CoAP UDP RPL IPv6 / 6LoWPAN 802.15.4, BLE, LoRAโฆ ISM band
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Content Aware Transport Routing Network
Medium Access Physical

Mechanisms
Pre-determined proxy -Reduced state & trickle Compressed pkt headers Minimized idle listening Low-power radio

IoT: Connecting the Physical World & Internet

Nature Monitoring
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Industry 4.0

Micro Satellites

Problem statement
Standard approach breaks if proxy/gateway is unavailable most of the time
รผ Nature monitoring
Periodic sensor data gathering via an UAV/drone
รผ Factory/storage monitoring
Periodic state check by roaming employees
รผ Micro satellites
Periodic data gathering via regular satellites
โ Trade-off: data availability vs energy efficiency
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Relevant IoT Data Metrics
โข Diversity:
Data from all sources is available.
โข Freshness:
The most up-to-date data is available.
โข Lifetime:
A sensor value is irrelevant after time L.
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

IoT Energy Efficiency
ยง Motivation ยง Cooperative caching with ICN-IoT ยง Experimental results
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Information Centric Networking (ICN) for IoT ?
โข Experimental research enabled by RIOT

ZOOM
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

ยง ICN principle: instead of focusing first on connecting machines, directly focus on accessing (named) data.
ยง ICN aim: simplified network stack with only two types of packets:
ยง Interest ยง Data (chunks)
E.Baccelli, C. Mehlis, O. Hahm, TC Schmidt, M. Wรคhlisch, โโInformation centric networking in the IoT: Experiments with NDN in the wild,โโ in ACM ICN, Sept. 2014.

Idea: NDN+CoCa (Cooperative Caching)
โข Intuition: few active devices = no energy vs availability trade-off

Interplay of sleeping and ICN

A

caching & replication?

B

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Smart Interplay of IoT protocols, OS & HW
โข Design & study of strategies for ICN caching & replication
โข Experiments with low-power IoT hardware & OS capabilities
รผ not only radio duty cycling, but make also the MCU sleep รผ consider both newer & legacy IoT hardware

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

O. Hahm et al. โโ Low-power Internet of Things with NDN and Cooperative Caching,โโ in ACM ICN, Sept. 2017.

Needed NDN Adaptations
รผSupport for content push
โข mixture of Interest-Interest, and Immediate Broadcast
รผSupport for name wildcards
โข in PIT & in Interests, of the shape /โ or <prefix>/โ โข Still: one content chunk sent per Interest
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

NDN+CoCa strategies

Sleeping Strategies โข Baseline: Radio Duty Cycling

Replication Strategies โข Baseline: single broadcast

โข Uncoordinated Sleeping

โข Rebroadcast for selected content

โข Coordinated Sleeping: Deputy on Watch
Caching Strategies

โข Baseline: Random Caching

โข Max-Diversity Most Recent (MDMR)

โข P-MDMR: โhardwiredโ name pref.

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Simple analysis of NDN+CoCa with MDMR

Simplification: no radio interference Uncoordinated sleeping
ร independent events ร Bernoulli trials
|S| := Number of sensor sources
ํตํฑ: := Number of designated caching nodes for content i
L := Lifetime of data
ํตํฑ2 := Probability of being awake

availability of content for L=1

ํตํดผ ํตํฑํตํฑํตํฑํตํฑํตํฑํตํฑํตํฑกํตํฑํตํฑํตํฑํตํฑ ํตํฑํตํฑํตํฑํตํฑกํตํฑํตํฑํตํฑก = |ํตํฑ|(1 โ ( 1 โ ํตํฑ2 1 โ ํตํฑ2 + ํตํฑ2 1 โ ํตํฑ2 4 5678 )

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

IoT Energy Efficiency
ยง Motivation ยง Cooperative caching with ICN-IoT ยง Experimental results
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Experimental approach
รผImplementation in
โข Using ICN pkg:
รผUsed same code for:
โข Emulation on RIOT emulator
โข virtual network with configurable topologies โข up to 1000 emulated IoT devices on a standard PC
โข Experiments on
โข heterogeneous hardware in various physical topologies โข up to 350 IoT devices at one site
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Comparing CoCa (MDMR) to random caching
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Matching model & experiment (with RIOT on IoT-Lab)
L=โ
L=4 L=3 L=2
L=1

Availability

Theoretical Analysis
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Testbed results: IoT-Lab in Lille

Scaling up
RIOT emulation with 1,000 nodes
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Summary
โข Significantly less energy consumption is possible with ICN
โข Compliant with basic NDN โข Works also on very low-memory IoT devices โข Works on top of any broadcast-capable network layer
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Agenda
ยง Context ยง RIOT ยง IoT Energy Efficiency ยง IoT Security ยง RIOT & SILECS
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

IoT Security
ยง IoT Attack Surface ยง RIOT Security
ยง Today ยง Next level
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

IoT Bottleneck: Security
ยง Today's IoT: not an acceptable tradeoff w.r.t. functionalities vs risks
ยง B. Schneier: Internet of (Unsecure) Things*
ยง Dimensions of the work needed to change that?
ยง Improving functionality ยง Better IoT hardware ยง Richer IoT software
ยง Mitigating risks ยง More IoT security
* https://www.rsaconference.com/blogs/bruce-schneier-talks-about-securing-the-world-sized-web-at-rsac-apj-2016
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Traditional IT Attack Surface
ยง Human vector
ยง Misconfiguration, phishing, social engineering ยง 95% security incidents involve human error*
ยง Hardware vector
ยง e.g. Spectre & Meltdown vulnerabilities on recent processors: leaks breaking isolation
ยง โฆ and backdoors from NSA & co ?

xkcd.com No 1938

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

* Cybersecurity Intelligence Index, IBM, 2014.

Traditional IT Attack Surface
ยง Low-level software vector
ยง e.g. EternalBlue vunerability on Windows <10 (NSA exploit turned bad, used in WannaCry)
ยง e.g. HeartBleed OpenSSL (also on Linux!) ยง Fatal combination: exploit OS & network stack
vulnerabilities to inject malicious code
ยง High-level software vector
ยง e.g. malicious PDF exploiting Adobe Reader vulnerabilities
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

itsecurityguru.org

Traditional IT Attack Surface
ยง Software supply-chain vector
ยง e.g. backdoor hacked into software updates of Ccleaner application*
ยง attack laced legitimate software with malware (distributed by a security company!!!)

xda-developers.com

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

* www.wired.com/story/ccleaner-malware-supply-chain-software-security

IoT vs Traditional IT Attack Surface

ยง IoT๏ฝMachine-to-Machine: the human factor is less important

ยง Single binary systems (so far)
ยง no high-level software

iotworm.com

ยง Low-end memory, CPU capacities
ยง kBytes of memory instead of Gbytes or more ยง MHz instead of GHz ยง mW or less, instead of W or more

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

nbcnews.com

IoT vs Traditional IT Attack Surface
ยง IoT๏ฝgiant cyberphysical robot: hacked system can cause direct physical harm
โ acceptable risks are changed
ยง Sensors everywhere, all the time
โ scope of privacy breaches are changed
ยง Industrial IoT applications*
โ required level of system availability is higher
* AR Sadeghi et al. "Security and Privacy Challenges in Industrial Internet of Things," in ACM DAC, 2015.
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

In a nutshell
ยง Humans ยง Hardware ยง Low-level software ยง High-level software ยง Software supply-chain
ยง Good news:
ยง attack surface might be smaller than usual
ยง Bad news:
ยง harsher contraints & potentially more impactful attacks ยง no human in the loop means its harder for some aspects (bootstrapโฆ)
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

IoT Security
ยง IoT Attack Surface ยง RIOT Security
ยง Today ยง Next level
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

RIOT Security Today: Basics
ยง State-of-the-art crypto primitives
ยง Symmetric crypto ยง Asymmetric crypto (elliptic-curve)
ยง 1000 eyes
ยง Clean, open-source code ยง Low number of LoC (total ~500k LoC)
ยง Standard process in place to handle zero-day vulnerabilities
ยง security@riot-os.org
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Next-level Security in RIOT
Trends towards:
ยง Crypto primitives: higher speed, stronger security, smaller memory footprint ยง Formally verified IoT software modules ยง Secured IoT software updates & supply-chain ยง Trusted execution
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

IoT Crypto Primitives
ยง Devices deployed now will last for years
ยง Maybe decades!
ยง MSP430 runs 12 years on an AA battery. ยง Energy harvesting
ยง Future-proof crypto is thus crucial. Quantum resistance?
ยง Trade-off: key & signature size vs speed * ยง ex. ECC 256b key vs McEliece 500kB key ยง ex. ECC 80B signature vs MQDSS 40kB signature

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

* S. Samardjiska 'Post Quantum Cryptography for the IoT,' RIOT Summit, 2017

IoT Crypto Primitives
It is nevertheless possible to prepare IoT crypto for post-quantum now ยง symmetric crypto needs upgrade but same security =~ double key size ยง asymmetric crypto
ยง some techniques would break entirely (e.g. RSA?) ยง some techniques are quantum-resistant (hash-based signaturesโฆ)
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Considered IoT Crypto Primitives
ยง IoT Symmetric Crypto ยง IoT Asymmetric Crypto ยง Operations over Encrypted IoT Data
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

IoT Symmetric Crypto

ยง Symmetric = same key everywhere.
More flexible primitives: SHA-3โs sponge construction* for hashing ยง Easy to (re)configure security level
ยง Just vary capacity c
ยง Shared code can provide various functions
ยง Pseudo-random number generator ยง Message authentication code (MAC) ยง Stream encryption ยง (more with the duplex construction)
ยง Initiating experimental work to evaluate this prospect on top of RIOT
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

G. Van Assche 'Permutation-based cryptography for the IoT,' RIOT Summit, 2017.
* G. Bertoni et al. 'Cryptographic sponge functionsโ, 2011.

IoT Asymmetric Crypto
ยง Symmetric crypto:
ยง communicating entities need a shared secret (the key) โ key distribution problem, Pre-Shared Key (PSK) is norm on IoT
ยง Asymmetric crypto with public/private keys:
ยง Public Key Infrascruture (PKI) solves key distribution ยง Public key allows digital signatures
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

IoT Asymmetric Crypto
Smaller & faster crypto
ยง more efficient implementation
ยง tweetnacl (Bernstein et al.): Source funnily fits in 100 tweets, using curve25519
ยง more efficient algorithms (GRACE Inria)
ยง uKummer *: Smarter use of algebraic geometry
ยง software-only hyperelliptic cryptography on constrained platforms ยง demonstrated on AVR 8-bit and ARM Cortex-M 32-bit ยง up to 70% faster & 80 % smaller compared to using curve25519
ยง qDSA **: even smaller stack & code size
ยง a qDSA packge was merged into RIOT last week
* J. Renes et al. โฮผKummer: Efficient hyperelliptic signatures and key exchange on microcontrollersโ, CHES, 2016. ** J. Renes, B. Smith โqDSA: Small and Secure Digital Signatures with Curve-based DiffieโHellman Key Pairsโ, ASIACRYPT 2017.
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Operations over Encrypted IoT Data
The cloud, or the server hosting IoT database may not be trusted โ Nevertheless it may be required to (batch) process IoT data
ยง Use of partially homomorphic crypto
ยง Talos and Pilatus prototype platforms * ยง Allows some operations (range, sum) over encrypted data ยง Using Elliptic-Curve ElGamal crypto-system (instead of Paillier) ยง Encryption by low-end IoT devices themselves (demonstrated on Cortex-M3)
* H. Shafagh et al. 'Secure Sharing of Partially Homomorphic Encrypted IoT Data,' ACM SenSys, 2017
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Operations over Encrypted IoT Data
ยง Body of work on differential privacy in the field of smart metering *
ยง Followed seminal work from Dwork in 2006
ยง Principle: add (some) noise to IoT data points
ยง Differential guarantee = analysts draws same conclusions about an individual whether the individual includes himself in the dataset or not
ยง Still able to extract coarse signal from aggregate data (e.g. mean, averageโฆ) ยง No privacy violation in practice
* V. Rastogi et al. โDifferentially Private Aggregation of Distributed Time-Series with Transformation and Encryptionโ, ACM SIGMOD 2011.
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Next-level Security in RIOT
Trends towards:
ยง Crypto primitives: higher speed, stronger security, smaller memory footprint ยง Formally verified IoT software modules ยง Secured IoT software updates & supply-chain ยง Trusted execution
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Humans (even if skilled) make buggy code
ยง Formally verified crypto code
ยง HACL* library: written in F* programming language (PROSECCO Inria) ยง F* code formally verified (memory safety, mitigations against timing
side-channels, and functional correctness) ยง F* code then compiled to readable C code
ยง Elements of HACL* already in Firefox ยง HACL* currently being integrated into RIOT
ยง Next :
ยง critical network stack elements (TLS 1.3) generated with F* ยง critical system modules (parts of the kernel) generated with F*
* JK Zinzindohouรฉ et al. โHACL*: A verified modern cryptographic library,โ ACM CCS, 2017
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Towards RIOT Kernel Formal Verification?
ยง RIOT kernel is small: 2600 lines of .c and 4200 lines of .h ยง First step: using Frama-C, annotate the kernel and prove correctness
ยง Method manipulating functional specifications, and then proving that the source code satisfies these specifications
ยง Next, consider full kernel reimplementation in F* ?
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Next-level Security in RIOT
Trends towards:
ยง Crypto primitives: higher speed, stronger security, smaller memory footprint ยง Formally verified IoT software modules ยง Secured IoT software updates & supply-chain ยง Trusted execution
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

You canโt secure what you canโt update

Developer:
Builds, signs & uploads updates
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Internet/cloud

Update Server:
stores updates
& serves them
to IoT devices

Border router:
Connects device to the Internet

IoT device:
Downloads, verifies
and boots updates

Full IoT Software Updates: Firmware Updates
You thought you were tight w.r.t. memory?

OS Image 2
Metadata
OS Image 1
Metadata
Bootloader
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Memory must be further split : ยง Bootloader
ยง (e.g. minimalistic config or RIOT)
ยง Several OS Images
ยง Typically need >2 for roll-back
ยง Metadata
ยง IETF working group SUIT working on standardizing metadata for IoT firmware *
* https://datatracker.ietf.org/group/suit/documents/

Partial IoT Software Updates

Efficiency of firmware updates? โ try partial software update

Various approaches:
ยง differential updates of arbitrary parts of the binary โ Efficient but risky

OS Image

ยง modular program & dynamic binary module loading โ More robust but more complex
ยง use interpreted languages (instead of compiled) โ Elegant but interpreter overhead

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Runtime .js container demonstrated to work on Cortex-M based low-end IoT devices with RIOT *
โ next: explore sandboxing properties of this contruct?
* E. Baccelli et al. "Scripting Over-The-Air: Towards Containers on Lowend Devices in the Internet of Things," IEEE PerCom, 2018 (to appear).

Trusting IoT Software Supply

xda-developers.com

Need to verify legitimacy of software updates!

ยง SUIT working group at IETF: metadata format + signatures etc. for IoT firmware
ยง https://datatracker.ietf.org/group/suit/documents/

ยง CHAINIAC * decentralized framework to verify software update legitimacy
ยง source code & binaries with reproducible builds ยง collective signing & blockchain-like decentralized consensus on release history ยง Series of work on this topic from J. Cappos group at NYU

Side note: enforcing legitimacy can turn bad -- beware of Treacherous Computing (R. Stallman)

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

* K. Nikitin et al. โCHAINIAC: Proactive Software-Update Transparency via Collectively Signed Skipchains and Verified Builds,โ USENIX Security Symposium, 2017.

Trusting IoT Software Supply

SECURITY xda-developers.com

ยง Of course you also need secure network protocolsโฆ

Content Aware Transport

OSCORE end-to-end encryption, integrity, & replay protection for CoAP (header/payload)
DTLS (over UDP) for confidentiality, integrity, authenticity with public/private keys

Routing Network

(secure join, routing protocol securityโฆ)

Medium Access

Link-layer security sublayer for authentication, confidentiality, with symmetric keys

Physical
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Next-level Security in RIOT
Trends towards:
ยง Crypto primitives: higher speed, stronger security, smaller memory footprint ยง Formally verified IoT software modules ยง Secured IoT software updates & supply-chain ยง Trusted execution
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Trusted Execution on IoT Hardware
ยง Principle: secure area of a processor for isolated execution, integrity of trusted applications & confidentiality of their assets
ยง Sancus* on MSP430 16-bit microcontrollers (OpenMSP430)
ยง Prototype isolating software components via memory curtaining
ยง Added MMU and crypto HW unit on openMSP430 (open source!) ยง Text/Data/ProgramCounter states monitoring/matching, per software component
ยง Remote attestation & authenticates communication with software component
ยง HW crypto enables key derivation per software component
ยง Sancus2.0 tested in automotive context. Claims only 6% energy overhead ยง Project initiated by KU Leuven to integrate RIOT and Sancus
ยง Similar: TrustZone for popular ARM Cortex-M 32-bit microcontrollers
ยง Upcoming Cortex-M33 and Cortex-M23 micro-controllers
* J. Noormans et al. 'Sancus 2.0: A Low-Cost Security Architecture for IoT Devices', ACM Transactions on Privacy and Security, 2017
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Trusted Execution on IoT Hardware
ยง TEEP working group at IETF *
ยง Context: delete, update applications running in the TEE ยง Goal: communication between the TEE, a relay outside TEE & a remote server
โ Trusted execution environment protocol (TEEP)
Side note: installing new software in the TEE increases attack surfaceโฆ

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

* https://datatracker.ietf.org/wg/teep/documents/

Agenda
ยง Context ยง RIOT ยง IoT Energy Efficiency ยง IoT Security ยง RIOT & SILECS
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

RIOT: Tools & Community Processes
ยง One release every 3 month: <year>.<month> (2018.01, 2018.04, etc)
ยง In-depth code reviews
ยง Including C99 compliance
ยง Nightly builds ยง Online documentation generated with Doxygen
โ https://doc.riot-os.org

ยง Distributed Continuous Integration: Murdock https://ci.riot-os.org

ยง Build for all targets (more than 15k configurations!)

ยง Static tests (Cppcheck, Coccinelle, etc) โ Hardware in the loop (WIP)

SILECS ?

Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Conclusion
RIOT is a natural extension to FIT IoT-Lab, allowing: ยง within IoT-Lab, easy & advanced programming of IoT-lab nodes ยง beyond IoT-Lab running the same code on 100+ other types boards There is a large & lively community around RIOT: ยง On-going academic research ยง Industry is part-taking There is lot still to do. Help & ideas are welcome!
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

Thanks! Questions?
github.com/RIOT-OS/RIOT
Emmanuel Baccelli, Inria โ SILECS workshop, 04.04.2018

